<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MalukuInfraZone</title>
<link rel="icon" href="images/logo-pu.png">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Montserrat:wght@700;900&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#071016;
  --glass:rgba(10,18,28,0.78);
  --navy:#0f3556;
  --accent:#f3b41f;
  --muted:#9fb0c6;
  --text-light:#f1f5f9;
  --ff-sans:"Poppins",system-ui,Arial;
}

/* NAV & BUTTONS */
.btn, #top-nav a.nav-link {
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:10px 16px;border-radius:12px;font-weight:800;text-decoration:none;
  cursor:pointer;transition:transform .12s,box-shadow .12s,background .12s;
  box-shadow:0 8px 20px rgba(2,6,23,0.45);
}
#top-nav a.nav-link {background:transparent;color:var(--text-light);border:1px solid rgba(255,255,255,0.03);}
.hero .btn {background:var(--accent);color:#071016;border:none;}
#top-nav a.nav-link.active {background:var(--navy);color:var(--accent);border:none;box-shadow:0 10px 30px rgba(4,26,54,0.55);transform:translateY(-2px);}
#top-nav a.nav-link:hover, .btn:hover {transform:translateY(-3px);box-shadow:0 12px 28px rgba(2,6,23,0.55);}

/* BASE */
html,body{height:100%;margin:0;font-family:var(--ff-sans);background:var(--bg);color:var(--text-light);padding-top:72px}
a{color:inherit;text-decoration:none}

/* HEADER */
header{position:fixed;top:0;left:0;right:0;z-index:60;display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:var(--glass);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.03)}
.brand{display:flex;align-items:center;gap:12px}
.brand img{height:40px}
.site-title{font-family:'Montserrat';font-weight:800;font-size:20px}
nav{display:flex;align-items:center;gap:12px}
nav a{padding:8px 12px;border-radius:8px;color:var(--text-light);font-weight:600}
nav a.active{background:var(--accent);color:#071016;font-weight:800;box-shadow:0 6px 18px rgba(0,0,0,0.45)}

/* HERO */
.hero{height:62vh;background:url('images/background-maluku.jpg') center/cover;display:flex;align-items:center;justify-content:center;position:relative}
.hero::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.52),rgba(0,0,0,0.78));}
.hero-inner{position:relative;z-index:10;text-align:center;padding:20px;max-width:960px}
.hero h1{font-family:'Montserrat';font-weight:900;font-size:44px;margin:0;}
.hero p{color:var(--muted);margin-top:10px;font-size:16px;}
.hero .cta-row{margin-top:18px;display:flex;gap:12px;justify-content:center}
.btn-primary,.btn-secondary{background:var(--accent);color:#071016;padding:12px 18px;border-radius:12px;font-weight:800}

/* SEKTOR */
.section{padding:54px 18px;max-width:1200px;margin:0 auto}
.sector-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px}
.sector-card{background:rgba(255,255,255,0.02);padding:16px;border-radius:10px;text-align:center}
.sector-card img{width:48px;height:48px;object-fit:contain}
.sector-card h3{color:var(--accent);margin:8px 0 4px;font-size:15px;font-weight:700}
.sector-card p{color:var(--muted);font-size:13px;margin:0}

/* DASHBOARD */
.dashboard{background:linear-gradient(180deg,rgba(6,10,14,0.65),rgba(6,10,14,0.45));padding:36px 18px;border-top:2px solid rgba(255,255,255,0.03)}
.container{max-width:1200px;margin:0 auto;display:flex;flex-direction:column;align-items:center}
.recap-header{width:100%;max-width:1120px;background:rgba(255,255,255,0.02);padding:12px 14px;border-radius:8px;margin-bottom:12px;text-align:center}
.recap-header h2{margin:0;font-family:'Montserrat';font-weight:900;font-size:20px;color:var(--text-light)}
.recap-header p{margin:6px 0 0;color:var(--muted);font-size:13px}

/* CARD GRID */
.cards-row{display:flex;justify-content:center;gap:22px;flex-wrap:wrap;margin-bottom:20px;}
.card{background:linear-gradient(180deg,rgba(11,19,30,0.78),rgba(8,12,18,0.7));border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(4,26,54,0.35);overflow:hidden;width:320px;max-width:90%;transition:transform .2s}
.card:hover{transform:translateY(-4px);}
.card-head{text-align:center;background:linear-gradient(180deg,rgba(12,39,62,0.98),rgba(9,31,50,0.92));padding:14px 10px;}
.card-head h4{font-size:13px;margin:0;color:var(--accent);font-weight:800;}
.card-head .title-line{font-size:15px;margin-top:8px;font-weight:800;color:var(--text-light);display:block;}
.card-head .label-small{margin-top:10px;font-size:11px;color:#d6e8fb;font-weight:700;display:block;}
.card-head .jumlah{font-size:20px;margin-top:6px;font-weight:900;color:var(--text-light);display:block;}
.card-head .invest-label{margin-top:10px;font-size:11px;color:#d6e8fb;font-weight:700;display:block;}
.card-head .invest-value{font-size:14px;margin-top:6px;color:var(--accent);font-weight:800;display:block;}
.body{padding:12px;background:rgba(255,255,255,0.02);}
.section-title{text-align:center;background:var(--navy);color:#fff;padding:6px 10px;border-radius:8px;font-weight:700;margin:0 auto 10px;width:86%;}
.util-row,.status-row{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 6px;color:var(--muted);font-size:13px;}
.util-row .k,.status-row .k{flex:1;color:#dfe9f5;}
.util-row .v,.status-row .v{flex:0 0 auto;color:var(--muted);white-space:nowrap;}
@media(max-width:1100px){.card{width:300px;}}
@media(max-width:740px){.card{width:100%;}.util-row .k,.util-row .v{white-space:normal;}}
</style>
</head>

<body>
<header>
  <div class="brand">
    <img src="images/favicon.png" alt="logo">
    <div class="site-title">MalukuInfraZone</div>
  </div>
  <nav id="top-nav">
    <a href="#hero" class="nav-link" id="nav-home">Beranda</a>
    <a href="peta.html" class="nav-link" id="nav-peta">Peta Infrastruktur</a>
    <a href="#dashboard" class="nav-link" id="nav-dashboard">Dashboard</a>
  </nav>
</header>

<section class="hero" id="hero">
  <div class="hero-inner">
    <h1>Platform Digital BPBPK Maluku</h1>
    <p>Transparansi Data — Akses Informasi Infrastruktur Terbangun BPBPK Maluku</p>
    <div class="cta-row">
      <a class="btn" href="#dashboard">Lihat Dashboard</a>
      <a class="btn" href="peta.html">Peta Infrastruktur</a>
    </div>
  </div>
</section>

<section class="section">
  <h2 style="text-align:center;font-family:Montserrat;font-weight:800;">Sektor-Sektor di BPBPK Maluku</h2>
  <div class="sector-grid">
    <div class="sector-card"><img src="images/icon-air.png"><h3>Air Minum</h3><p>Penyediaan infrastruktur air minum layak bagi masyarakat Maluku.</p></div>
    <div class="sector-card"><img src="images/icon-sanitasi.png"><h3>Sanitasi</h3><p>Pembangunan dan pengelolaan sanitasi untuk lingkungan sehat.</p></div>
    <div class="sector-card"><img src="images/icon-bina.png"><h3>Penataan Bangunan</h3><p>Penataan dan pengawasan kualitas bangunan.</p></div>
    <div class="sector-card"><img src="images/icon-kawasan.png"><h3>Kawasan Strategis</h3><p>Pengembangan kawasan prioritas di Maluku.</p></div>
  </div>
</section>

<section id="dashboard" class="dashboard">
  <div class="container">

    <div class="recap-header">
      <h2>Rekapitulasi Status Keberfungsian Infrastruktur Reguler Terbangun Tahun Anggaran 2020–2024</h2>
      <p>Ringkasan per sektor. Angka jumlah, nilai investasi, utilisasi (termasuk satuan), dan status keberfungsian.</p>
    </div>

    <div id="cards-reg-top" class="cards-row"></div>
    <div id="cards-reg-bottom" class="cards-row"></div>

    <div style="height:22px"></div>

    <div class="recap-header">
      <h2>Rekapitulasi Status Keberfungsian Infrastruktur IBM Terbangun Tahun Anggaran 2020–2024</h2>
      <p>Ringkasan program IBM. Angka jumlah, nilai investasi, utilisasi (termasuk satuan) dan status keberfungsian.</p>
    </div>

    <div id="cards-ibm-top" class="cards-row"></div>
    <div id="cards-ibm-bottom" class="cards-row"></div>

  </div>
</section>

<footer style="text-align:center;padding:24px;color:var(--muted);background:var(--bg)">
  &copy; 2025 MalukuInfraZone - BPBPK Maluku
</footer>

<script>
async function loadJSON(p){try{const r=await fetch(p);return await r.json()}catch{return[]}}
function pick(o,k){for(const i of k)if(o&&o[i]!=null&&String(o[i]).trim()!=='')return o[i];return null}
function formatInvest(v){if(v==null||v==='')return'Rp 0';const n=Number(String(v).replace(/[^0-9.-]+/g,''));return!isNaN(n)?'Rp '+n.toLocaleString('id-ID',{minimumFractionDigits:2,maximumFractionDigits:2})+' Miliar':String(v)}

function buildCardFlex(prefix,name,jumlah,invest,utilRows,statusRows){
 const utilHtml=(utilRows&&utilRows.length)?
 `<div class="body"><div class="section-title">Utilisasi</div>${utilRows.map(r=>`<div class="util-row"><div class="k">${r[0]}</div><div class="v">${r[1]||'-'}</div></div>`).join('')}</div>`:'';
 const statusHtml=`<div class="body"><div class="section-title">Status Keberfungsian</div>${statusRows.map(r=>`<div class="status-row"><div class="k">${r[0]}</div><div class="v">${r[1]||'-'}</div></div>`).join('')}</div>`;
 return `<div class="card"><div class="card-head"><h4>${prefix}</h4><span class="title-line">${name}</span><span class="label-small">JUMLAH</span><span class="jumlah">${jumlah}</span><span class="invest-label">NILAI INVESTASI</span><span class="invest-value">${invest}</span></div>${utilHtml}${statusHtml}</div>`;
}

function mapItem(i){
 const name=pick(i,['Sektor','Program','Nama','Nama Program'])||'-';
 const jumlah=String(pick(i,['Jumlah Unit','Jumlah','Unit'])??'-');
 const invest=formatInvest(pick(i,['Nilai Investasi (Miliar)','Nilai Investasi','Investasi']));
 const satuanKap=pick(i,['Satuan Kapasitas','Satuan'])||'', satuanLuas=pick(i,['Satuan Luas'])||'';
 const util=[], kt=pick(i,['Kapasitas Terpasang']), kp=pick(i,['Kapasitas Terpakai']), idle=pick(i,['Idle Capacity','Idle']), luasPen=pick(i,['Luas Penanganan']), luasKaw=pick(i,['Luas Kawasan','Luas Total Kawasan']);
 if(kt!==null)util.push(['Kapasitas Terpasang',`${kt}${satuanKap?' '+satuanKap:''}`]);
 if(kp!==null)util.push(['Kapasitas Terpakai',`${kp}${satuanKap?' '+satuanKap:''}`]);
 if(idle!==null)util.push(['Idle Capacity',`${idle}${satuanKap?' '+satuanKap:''}`]);
 if(luasPen!==null)util.push(['Luas Penanganan',`${luasPen}${satuanLuas?' '+satuanLuas:''}`]);
 if(luasKaw!==null)util.push(['Luas Total Kawasan',`${luasKaw}${satuanLuas?' '+satuanLuas:''}`]);
 const berf=pick(i,['Berfungsi','Berfungsi Unit']),tbf=pick(i,['Tidak Berfungsi','Tidak Berfungsi Unit']);
 const status=[['Berfungsi',berf??'-'],['Tidak Berfungsi',tbf??'-']];
 return{prefix:'Infrastruktur',name,jumlah,invest,util,status};
}

function renderRowsFlex(topId,bottomId,data){
 const t=document.getElementById(topId),b=document.getElementById(bottomId);
 t.innerHTML='';b.innerHTML='';
 const list=Array.isArray(data)?data:[];
 list.slice(0,3).forEach(it=>{const f=mapItem(it);t.insertAdjacentHTML('beforeend',buildCardFlex(f.prefix,f.name,f.jumlah,f.invest,f.util,f.status));});
 list.slice(3,5).forEach(it=>{const f=mapItem(it);b.insertAdjacentHTML('beforeend',buildCardFlex(f.prefix,f.name,f.jumlah,f.invest,f.util,f.status));});
}

async function loadAndRender(){
 const reg=await loadJSON('data/rekap_reguler.json'),ibm=await loadJSON('data/rekap_ibm.json');
 renderRowsFlex('cards-reg-top','cards-reg-bottom',reg);
 renderRowsFlex('cards-ibm-top','cards-ibm-bottom',ibm);
}

function setActiveNav(){
 const sections=[{id:'hero',nav:'nav-home'},{id:'dashboard',nav:'nav-dashboard'}];
 const offset=window.scrollY+80;let active='nav-home';
 for(const s of sections){const el=document.getElementById(s.id);if(el&&el.offsetTop<=offset)active=s.nav;}
 document.querySelectorAll('#top-nav a').forEach(a=>a.classList.remove('active'));
 const act=document.getElementById(active);if(act)act.classList.add('active');
}

document.querySelectorAll('a[href^="#"]').forEach(a=>{
 a.addEventListener('click',e=>{
   const target=a.getAttribute('href').slice(1);
   const el=document.getElementById(target);
   if(el){e.preventDefault();el.scrollIntoView({behavior:'smooth'});}
 });
});

window.addEventListener('load',()=>{loadAndRender();setActiveNav();});
window.addEventListener('scroll',setActiveNav);
</script>
</body>
</html>
