<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MalukuInfraZone</title>
  <meta name="description" content="Portal data dan peta infrastruktur BPBPK Maluku">

  <!-- Logo Web -->
  <link rel="icon" type="image/png" href="images/logo-pu.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700;900&family=Montserrat:wght@400;600;700;900&family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Styles -->
  <style>
    :root {
      --bg-dark: #0b0f17;
      --accent: #3b82f6;
      --accent-2: #f59e0b;
      --muted: #a7b6c8;
      --font-poppins: 'Poppins', sans-serif;
      --font-montserrat: 'Montserrat', sans-serif;
      --font-raleway: 'Raleway', sans-serif;
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: var(--font-poppins);
      background: var(--bg-dark);
      color: #fff;
      overflow-x: hidden;
      padding-top: 72px; /* ruang untuk header fixed */
    }

    /* ===== Header ===== */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 36px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
      background: rgba(11, 15, 23, 0.75);
      backdrop-filter: blur(8px);
      transition: background .3s ease, box-shadow .3s ease;
    }
    header.scrolled {
      background: rgba(11, 15, 23, 0.92);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .brand img {
      height: 44px;
    }
    .site-title {
      font-family: var(--font-raleway);
      font-weight: 800;
      font-size: 28px;
    }
    .nav a {
      margin-left: 22px;
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      transition: color .2s;
    }
    .nav a:hover {
      color: var(--accent);
    }

    /* ===== Hero ===== */
    .hero {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      flex-direction: column;
      position: relative;
      background: url('images/background-maluku.jpg') no-repeat center/cover;
    }
    .hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.7));
    }
    .hero-content {
      position: relative;
      z-index: 10;
      max-width: 880px;
      padding: 20px;
    }
    .hero h1 {
      font-size: 52px;
      font-family: var(--font-montserrat);
      font-weight: 900;
      margin: 0;
      letter-spacing: -0.02em;
    }
    .hero p {
      margin-top: 12px;
      color: var(--muted);
      font-size: 18px;
    }
    .btn-primary {
      margin-top: 24px;
      display: inline-block;
      padding: 14px 28px;
      border-radius: 999px;
      font-weight: 700;
      background: var(--accent);
      color: #021129;
      text-decoration: none;
      font-size: 18px;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .btn-primary:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 26px rgba(59,130,246,0.3);
    }

    /* Fade-in animations */
    .fade-in {
      opacity: 0;
      transform: translateY(8px);
      animation: fadeUp .7s ease forwards;
    }
    .fade-in.delay-1 { animation-delay: .12s; }
    .fade-in.delay-2 { animation-delay: .28s; }
    .fade-in.delay-3 { animation-delay: .44s; }
    @keyframes fadeUp {
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== Sectors ===== */
    .sectors {
      padding: 80px 20px;
      max-width: 1160px;
      margin: 0 auto;
      text-align: center;
    }
    .sectors h2 {
      font-size: 32px;
      font-family: var(--font-montserrat);
      font-weight: 800;
      margin-bottom: 40px;
    }
    .sector-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 28px;
    }
    .sector-card {
      background: #161b26;
      border-radius: 14px;
      padding: 24px;
      box-shadow: 0 6px 22px rgba(0,0,0,0.45);
      transition: transform .28s, box-shadow .28s;
      opacity: 0;
      transform: translateY(10px);
      animation: cardIn .6s ease forwards;
    }
    .sector-card:nth-child(1){ animation-delay: .12s; }
    .sector-card:nth-child(2){ animation-delay: .24s; }
    .sector-card:nth-child(3){ animation-delay: .36s; }
    .sector-card:nth-child(4){ animation-delay: .48s; }
    @keyframes cardIn {
      to { opacity: 1; transform: translateY(0); }
    }
    .sector-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
    }
    .sector-card .icon {
      width: 56px;
      height: 56px;
      display: inline-block;
      margin-bottom: 12px;
      object-fit: contain;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
    }
    .sector-card h3 {
      margin: 0 0 10px;
      font-size: 20px;
      font-weight: 700;
      color: var(--accent);
    }
    .sector-card p {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }

    /* ===== Footer ===== */
    footer {
      text-align: center;
      padding: 40px;
      color: var(--muted);
      font-size: 14px;
      background: #0b0f17;
    }
    footer .tagline {
      display: block;
      margin-top: 8px;
      font-size: 16px;
      color: #fff;
      font-weight: 600;
    }

    /* ===== Responsive ===== */
    @media(max-width:720px) {
      .hero h1 { font-size: 34px; }
      .hero p { font-size: 16px; }
    }
  </style>
</head>
<body>
  <!-- ===== Header ===== -->
  <header id="site-header">
    <div class="brand">
      <img src="images/favicon.png" alt="Logo MalukuInfraZone">
      <div class="site-title">MalukuInfraZone</div>
    </div>
    <nav class="nav">
      <a href="index.html">Beranda</a>
      <a href="peta.html">Peta Infrastruktur</a>
    </nav>
  </header>

  <!-- ===== Hero Section ===== -->
  <section class="hero">
    <div class="hero-content">
      <h1 class="fade-in delay-1">Platform Digital BPBPK Maluku</h1>
      <p class="fade-in delay-2">Transparansi Data â€” Akses Informasi Infrastruktur Terbangun Balai Penataan Bangunan, Prasarana dan Kawasan Maluku</p>
      <a href="peta.html" class="btn-primary fade-in delay-3">Lihat Peta Infrastruktur</a>
    </div>
  </section>

  <!-- ===== Sectors Section ===== -->
  <section class="sectors">
    <h2>Sektor-Sektor di BPBPK Maluku</h2>
    <div class="sector-list">
      <div class="sector-card">
        <img class="icon" src="images/icon-air.png" alt="Icon Air Minum">
        <h3>Air Minum</h3>
        <p>Menyediakan infrastruktur air minum yang layak untuk masyarakat Maluku.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-sanitasi.png" alt="Icon Sanitasi">
        <h3>Sanitasi</h3>
        <p>Pembangunan dan pengelolaan infrastruktur sanitasi yang mendukung kesehatan lingkungan.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-bina.png" alt="Icon Bina Penataan Bangunan">
        <h3>Bina Penataan Bangunan</h3>
        <p>Pengelolaan tata bangunan dan pengawasan kualitas pembangunan gedung.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-kawasan.png" alt="Icon Pengembangan Kawasan Strategis">
        <h3>Pengembangan Kawasan Strategis</h3>
        <p>Pengembangan kawasan strategis untuk mendukung pertumbuhan wilayah Maluku.</p>
      </div>
    </div>
  </section>

<script>
(function(){
  const PATH_REG = 'data/rekap_reguler.json';
  const PATH_IBM = 'data/rekap_ibm.json';
  const grid = document.getElementById('rekapGrid');
  const tabs = { all: document.getElementById('tab-all'), reg: document.getElementById('tab-reg'), ibm: document.getElementById('tab-ibm') };
  let dataReg = [], dataIbm = [];

  function setActive(btn){
    Object.values(tabs).forEach(b=>{
      b.style.background='transparent';
      b.style.color='var(--muted)';
      b.style.borderColor='rgba(255,255,255,0.06)';
    });
    btn.style.background='#08263f';
    btn.style.color='#ffd54f';
    btn.style.borderColor='#08263f';
  }

  function cap(v){ return v===undefined || v==='' ? '-' : v; }
  function fmtNum(n, decimals=2){
    if(n===null||n===undefined||n==='-'||n==='') return '-';
    const num = Number(String(n).replace(/[^0-9.-]/g,''));
    if(isNaN(num)) return n;
    return num.toLocaleString('id-ID', {minimumFractionDigits: 0, maximumFractionDigits: decimals});
  }

  function buildBadge(text, color){
    const badge = document.createElement('div');
    badge.textContent = text;
    badge.style.position = 'absolute';
    badge.style.top = '10px';
    badge.style.right = '12px';
    badge.style.background = color;
    badge.style.color = '#021129';
    badge.style.fontWeight = 700;
    badge.style.fontSize = '11px';
    badge.style.padding = '4px 8px';
    badge.style.borderRadius = '6px';
    badge.style.boxShadow = '0 2px 6px rgba(0,0,0,0.25)';
    return badge;
  }

  function buildCard(title, dataObj, satuan, type){
    const card = document.createElement('div');
    card.style.background = '#0f1620';
    card.style.border = '1px solid rgba(255,255,255,0.05)';
    card.style.borderRadius = '12px';
    card.style.padding = '16px';
    card.style.position = 'relative';
    card.style.boxShadow = '0 8px 28px rgba(0,0,0,0.45)';

    const badgeColor = type === 'ibm' ? '#fcd34d' : '#3b82f6';
    card.appendChild(buildBadge('Data s.d. 2024', badgeColor));

    const titleDiv = document.createElement('div');
    titleDiv.textContent = title;
    titleDiv.style.fontFamily = 'var(--font-montserrat)';
    titleDiv.style.fontWeight = 800;
    titleDiv.style.fontSize = '16px';
    titleDiv.style.color = badgeColor;
    titleDiv.style.marginBottom = '10px';
    card.appendChild(titleDiv);

    const inv = document.createElement('div');
    inv.style.background = '#08263f';
    inv.style.padding = '8px 10px';
    inv.style.borderRadius = '6px';
    inv.style.marginBottom = '12px';
    inv.style.display = 'flex';
    inv.style.justifyContent = 'space-between';
    inv.innerHTML = '<div style="font-size:13px;color:var(--muted)">Nilai Investasi</div><div style="font-weight:800;color:'+badgeColor+'">'+
      (dataObj['Nilai Investasi (Miliar)']?('Rp '+fmtNum(dataObj['Nilai Investasi (Miliar)'],2)+' M'):'-')+'</div>';
    card.appendChild(inv);

    const rows = [
      ['Jumlah Unit', dataObj['Jumlah Unit']],
      ['Berfungsi', dataObj['Berfungsi']],
      ['Tidak Berfungsi', dataObj['Tidak Berfungsi']],
      ['Kapasitas Terpasang', dataObj['Kapasitas Terpasang']],
      ['Kapasitas Terpakai', dataObj['Kapasitas Terpakai']],
      ['Idle Capacity', dataObj['Idle Capacity']],
      ['Luas Penanganan', dataObj['Luas Penanganan']],
      ['Luas Kawasan', dataObj['Luas Kawasan']]
    ];

    // Tampilkan hanya baris yang relevan (bukan kosong atau '-')
    rows.forEach((r,i)=>{
      const valRaw = r[1];
      if(valRaw===undefined || valRaw==='-' || valRaw===0 || valRaw==='0' || valRaw==='') return;
      
      const row=document.createElement('div');
      row.style.display='flex';
      row.style.justifyContent='space-between';
      row.style.padding='6px 4px';
      row.style.borderBottom='1px solid rgba(255,255,255,0.05)';
      const l=document.createElement('div');l.textContent=r[0];l.style.color='var(--muted)';l.style.fontSize='13px';
      const v=document.createElement('div');v.style.fontWeight='700';v.style.fontSize='13px';
      let val=valRaw;
      if(r[0].includes('Kapasitas') && val && val!=='-'){
        const num=Number(String(val).replace(/[^0-9.,]/g,'').replace(',','.'));
        val=isNaN(num)?val:fmtNum(num,2)+(satuan&&satuan!=='-'?' '+satuan:'');
      }
      v.textContent=cap(val);
      row.appendChild(l);row.appendChild(v);card.appendChild(row);
    });

    return card;
  }

  function isEmptySector(obj){
    const keys=['Jumlah Unit','Nilai Investasi (Miliar)','Berfungsi','Tidak Berfungsi','Kapasitas Terpasang','Kapasitas Terpakai','Idle Capacity'];
    return keys.every(k=>{
      const v=obj[k];
      return v===undefined||v==='-'||v===0||v==='0';
    });
  }

  function renderSectors(data,type){
    grid.innerHTML='';
    const order=['Air Minum','Air Limbah','Persampahan','PKS','BPB'];
    const map={};
    data.forEach(r=>{
      const key=(r.Sektor||'').trim()||'Unknown';
      if(!map[key]) map[key]=Object.assign({},r);
      else{
        const parseNum=v=>Number(String(v).replace(/[^0-9.,]/g,'').replace(',','.'))||0;
        map[key]['Jumlah Unit']=(Number(map[key]['Jumlah Unit']||0)+Number(r['Jumlah Unit']||0));
        map[key]['Nilai Investasi (Miliar)']=(Number(map[key]['Nilai Investasi (Miliar)']||0)+Number(r['Nilai Investasi (Miliar)']||0));
        map[key]['Berfungsi']=(Number(map[key]['Berfungsi']||0)+Number(r['Berfungsi']||0));
        map[key]['Tidak Berfungsi']=(Number(map[key]['Tidak Berfungsi']||0)+Number(r['Tidak Berfungsi']||0));
        map[key]['Kapasitas Terpasang']=(Number(map[key]['Kapasitas Terpasang']||0)+parseNum(r['Kapasitas Terpasang']));
        map[key]['Kapasitas Terpakai']=(Number(map[key]['Kapasitas Terpakai']||0)+parseNum(r['Kapasitas Terpakai']));
        map[key]['Idle Capacity']=(Number(map[key]['Idle Capacity']||0)+parseNum(r['Idle Capacity']));
      }
    });

    order.forEach(k=>{
      const item=map[k];
      if(!item || isEmptySector(item)) return;
      grid.appendChild(buildCard(item.Sektor,item,item['Satuan Kapasitas']||'-',type));
    });
    if(grid.children.length===0){
      grid.innerHTML='<div style="color:var(--muted);text-align:center;padding:20px;">Tidak ada data sektor aktif.</div>';
    }
  }

  function renderIbm(data){
    grid.innerHTML='';
    data.forEach(it=>{
      if(isEmptySector(it)) return;
      grid.appendChild(buildCard(it['Program'],it,it['Satuan Kapasitas']||'-','ibm'));
    });
    if(grid.children.length===0){
      grid.innerHTML='<div style="color:var(--muted);text-align:center;padding:20px;">Tidak ada data IBM aktif.</div>';
    }
  }

  Promise.all([fetch(PATH_REG).then(r=>r.json()), fetch(PATH_IBM).then(r=>r.json())])
  .then(([reg,ibm])=>{
    dataReg=reg; dataIbm=ibm;
    setActive(tabs.all);
    renderSectors(dataReg.concat(dataIbm),'gabungan');
  })
  .catch(err=>{
    grid.innerHTML='<div style="color:#ffb4b4">Gagal memuat data. Periksa path JSON di folder repo.</div>';
    console.error(err);
  });

  tabs.reg.addEventListener('click',()=>{setActive(tabs.reg);renderSectors(dataReg,'reguler');});
  tabs.ibm.addEventListener('click',()=>{setActive(tabs.ibm);renderIbm(dataIbm);});
  tabs.all.addEventListener('click',()=>{setActive(tabs.all);renderSectors(dataReg.concat(dataIbm),'gabungan');});
})();
</script>

 
  <!-- ===== Footer ===== -->
  <footer>
    &copy; 2025 MalukuInfraZone - BPBPK Maluku. Semua Hak Dilindungi.
    <span class="tagline">Transparansi Data, Akselerasi Pembangunan Negeri.</span>
  </footer>

  <!-- ===== Script Header Scroll ===== -->
  <script>
    const header = document.getElementById('site-header');
    function checkHeader() {
      if (!header) return;
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    }
    window.addEventListener('load', checkHeader);
    window.addEventListener('scroll', checkHeader, { passive: true });
  </script>
  
</body>
</html>
