<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MalukuInfraZone</title>
  <meta name="description" content="Portal data dan peta infrastruktur BPBPK Maluku">

  <!-- Logo Web -->
  <link rel="icon" type="image/png" href="images/logo-pu.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700;900&family=Montserrat:wght@400;600;700;900&family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Styles -->
  <style>
    :root {
      --bg-dark: #0b0f17;
      --accent: #3b82f6;
      --accent-2: #f59e0b;
      --muted: #a7b6c8;
      --font-poppins: 'Poppins', sans-serif;
      --font-montserrat: 'Montserrat', sans-serif;
      --font-raleway: 'Raleway', sans-serif;
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: var(--font-poppins);
      background: var(--bg-dark);
      color: #fff;
      overflow-x: hidden;
      padding-top: 72px; /* ruang untuk header fixed */
    }

    /* ===== Header ===== */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 36px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
      background: rgba(11, 15, 23, 0.75);
      backdrop-filter: blur(8px);
      transition: background .3s ease, box-shadow .3s ease;
    }
    header.scrolled {
      background: rgba(11, 15, 23, 0.92);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .brand img {
      height: 44px;
    }
    .site-title {
      font-family: var(--font-raleway);
      font-weight: 800;
      font-size: 28px;
    }
    .nav a {
      margin-left: 22px;
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      transition: color .2s;
    }
    .nav a:hover {
      color: var(--accent);
    }

    /* ===== Hero ===== */
    .hero {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      flex-direction: column;
      position: relative;
      background: url('images/background-maluku.jpg') no-repeat center/cover;
    }
    .hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.7));
    }
    .hero-content {
      position: relative;
      z-index: 10;
      max-width: 880px;
      padding: 20px;
    }
    .hero h1 {
      font-size: 52px;
      font-family: var(--font-montserrat);
      font-weight: 900;
      margin: 0;
      letter-spacing: -0.02em;
    }
    .hero p {
      margin-top: 12px;
      color: var(--muted);
      font-size: 18px;
    }
    .btn-primary {
      margin-top: 24px;
      display: inline-block;
      padding: 14px 28px;
      border-radius: 999px;
      font-weight: 700;
      background: var(--accent);
      color: #021129;
      text-decoration: none;
      font-size: 18px;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .btn-primary:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 26px rgba(59,130,246,0.3);
    }

    /* Fade-in animations */
    .fade-in {
      opacity: 0;
      transform: translateY(8px);
      animation: fadeUp .7s ease forwards;
    }
    .fade-in.delay-1 { animation-delay: .12s; }
    .fade-in.delay-2 { animation-delay: .28s; }
    .fade-in.delay-3 { animation-delay: .44s; }
    @keyframes fadeUp {
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== Sectors ===== */
    .sectors {
      padding: 80px 20px;
      max-width: 1160px;
      margin: 0 auto;
      text-align: center;
    }
    .sectors h2 {
      font-size: 32px;
      font-family: var(--font-montserrat);
      font-weight: 800;
      margin-bottom: 40px;
    }
    .sector-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 28px;
    }
    .sector-card {
      background: #161b26;
      border-radius: 14px;
      padding: 24px;
      box-shadow: 0 6px 22px rgba(0,0,0,0.45);
      transition: transform .28s, box-shadow .28s;
      opacity: 0;
      transform: translateY(10px);
      animation: cardIn .6s ease forwards;
    }
    .sector-card:nth-child(1){ animation-delay: .12s; }
    .sector-card:nth-child(2){ animation-delay: .24s; }
    .sector-card:nth-child(3){ animation-delay: .36s; }
    .sector-card:nth-child(4){ animation-delay: .48s; }
    @keyframes cardIn {
      to { opacity: 1; transform: translateY(0); }
    }
    .sector-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
    }
    .sector-card .icon {
      width: 56px;
      height: 56px;
      display: inline-block;
      margin-bottom: 12px;
      object-fit: contain;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
    }
    .sector-card h3 {
      margin: 0 0 10px;
      font-size: 20px;
      font-weight: 700;
      color: var(--accent);
    }
    .sector-card p {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }

    /* ===== Footer ===== */
    footer {
      text-align: center;
      padding: 40px;
      color: var(--muted);
      font-size: 14px;
      background: #0b0f17;
    }
    footer .tagline {
      display: block;
      margin-top: 8px;
      font-size: 16px;
      color: #fff;
      font-weight: 600;
    }

    /* ===== Responsive ===== */
    @media(max-width:720px) {
      .hero h1 { font-size: 34px; }
      .hero p { font-size: 16px; }
    }
  </style>
</head>
<body>
  <!-- ===== Header ===== -->
  <header id="site-header">
    <div class="brand">
      <img src="images/favicon.png" alt="Logo MalukuInfraZone">
      <div class="site-title">MalukuInfraZone</div>
    </div>
    <nav class="nav">
      <a href="index.html">Beranda</a>
      <a href="peta.html">Peta Infrastruktur</a>
    </nav>
  </header>

  <!-- ===== Hero Section ===== -->
  <section class="hero">
    <div class="hero-content">
      <h1 class="fade-in delay-1">Platform Digital BPBPK Maluku</h1>
      <p class="fade-in delay-2">Transparansi Data â€” Akses Informasi Infrastruktur Terbangun Balai Penataan Bangunan, Prasarana dan Kawasan Maluku</p>
      <a href="peta.html" class="btn-primary fade-in delay-3">Lihat Peta Infrastruktur</a>
    </div>
  </section>

  <!-- ===== Sectors Section ===== -->
  <section class="sectors">
    <h2>Sektor-Sektor di BPBPK Maluku</h2>
    <div class="sector-list">
      <div class="sector-card">
        <img class="icon" src="images/icon-air.png" alt="Icon Air Minum">
        <h3>Air Minum</h3>
        <p>Menyediakan infrastruktur air minum yang layak untuk masyarakat Maluku.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-sanitasi.png" alt="Icon Sanitasi">
        <h3>Sanitasi</h3>
        <p>Pembangunan dan pengelolaan infrastruktur sanitasi yang mendukung kesehatan lingkungan.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-bina.png" alt="Icon Bina Penataan Bangunan">
        <h3>Bina Penataan Bangunan</h3>
        <p>Pengelolaan tata bangunan dan pengawasan kualitas pembangunan gedung.</p>
      </div>
      <div class="sector-card">
        <img class="icon" src="images/icon-kawasan.png" alt="Icon Pengembangan Kawasan Strategis">
        <h3>Pengembangan Kawasan Strategis</h3>
        <p>Pengembangan kawasan strategis untuk mendukung pertumbuhan wilayah Maluku.</p>
      </div>
    </div>
  </section>

  <!-- ===== Footer ===== -->
  <footer>
    &copy; 2025 MalukuInfraZone - BPBPK Maluku. Semua Hak Dilindungi.
    <span class="tagline">Transparansi Data, Akselerasi Pembangunan Negeri.</span>
  </footer>

  <!-- ===== Script Header Scroll ===== -->
  <script>
    const header = document.getElementById('site-header');
    function checkHeader() {
      if (!header) return;
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    }
    window.addEventListener('load', checkHeader);
    window.addEventListener('scroll', checkHeader, { passive: true });
  </script>
<!-- START: Rekapitulasi (disesuaikan dengan style MalukuInfraZone) -->
<section id="rekap-section" style="max-width:1160px;margin:40px auto;padding:28px;border-radius:12px;">
  <h2 style="font-family:var(--font-montserrat);color:#fff;margin:0 0 18px;text-align:center;">Rekapitulasi Infrastruktur</h2>

  <div style="display:flex;gap:8px;justify-content:center;margin-bottom:18px;">
    <button id="tab-all" class="rekap-tab" style="padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#08263f;color:#ffd54f;font-weight:700">Gabungan</button>
    <button id="tab-reg" class="rekap-tab" style="padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);font-weight:600">Reguler</button>
    <button id="tab-ibm" class="rekap-tab" style="padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);font-weight:600">IBM</button>
  </div>

  <div id="rekapGrid" style="display:flex;flex-wrap:wrap;gap:18px;justify-content:center;"></div>
</section>

<script>
(function(){
  const PATH_REG = 'data/rekap_reguler.json';
  const PATH_IBM = 'data/rekap_ibm.json';

  const grid = document.getElementById('rekapGrid');
  const tabs = { all: document.getElementById('tab-all'), reg: document.getElementById('tab-reg'), ibm: document.getElementById('tab-ibm') };

  let dataReg = [], dataIbm = [];

  function setActive(btn){
    Object.values(tabs).forEach(b=>{
      b.style.background='transparent';
      b.style.color='var(--muted)';
      b.style.borderColor='rgba(255,255,255,0.06)';
    });
    btn.style.background='#08263f';
    btn.style.color='#ffd54f';
    btn.style.borderColor='#08263f';
  }

  function capv(v){ return v===undefined || v==='' ? '-' : v; }

  function buildCard(title, item, satuan){
    const card = document.createElement('div');
    card.className = 'sector-card';
    card.style.width = '320px';
    card.style.background = '#161b26';
    card.style.borderRadius = '12px';
    card.style.padding = '14px';
    card.style.boxShadow = '0 10px 30px rgba(0,0,0,0.45)';
    card.style.border = '1px solid rgba(255,255,255,0.03)';
    card.style.color = '#fff';

    const hdr = document.createElement('div');
    hdr.style.background = '#0b2740';
    hdr.style.padding = '12px';
    hdr.style.textAlign = 'center';
    hdr.style.fontWeight = 800;
    hdr.style.color = '#ffd54f';
    hdr.style.borderRadius = '8px';
    hdr.style.marginBottom = '10px';
    hdr.style.fontFamily = 'var(--font-montserrat)';
    hdr.textContent = title;
    card.appendChild(hdr);

    const body = document.createElement('div');
    body.style.fontFamily = 'var(--font-poppins)';
    body.style.fontSize = '14px';

    const rows = [
      ['Jumlah Unit', capv(item['Jumlah Unit'])],
      ['Nilai Investasi (Miliar)', capv(item['Nilai Investasi (Miliar)'])],
      ['Berfungsi', capv(item['Berfungsi'])],
      ['Tidak Berfungsi', capv(item['Tidak Berfungsi'])],
      ['Kapasitas Terpasang', capv(item['Kapasitas Terpasang']) + (satuan && satuan!=='-' ? ' ' + satuan : '')],
      ['Kapasitas Terpakai', capv(item['Kapasitas Terpakai']) + (satuan && satuan!=='-' ? ' ' + satuan : '')],
      ['Idle Capacity', capv(item['Idle Capacity']) + (satuan && satuan!=='-' ? ' ' + satuan : '')],
      ['Luas Penanganan', capv(item['Luas Penanganan'])],
      ['Luas Kawasan', capv(item['Luas Kawasan'])]
    ];

    rows.forEach((r,i) => {
      const row = document.createElement('div');
      row.style.display = 'flex';
      row.style.justifyContent = 'space-between';
      row.style.padding = '8px 6px';
      row.style.borderBottom = i < rows.length-1 ? '1px solid rgba(255,255,255,0.03)' : 'none';
      const label = document.createElement('div'); label.style.color = 'var(--muted)'; label.style.fontSize='13px'; label.textContent = r[0];
      const val = document.createElement('div'); val.style.fontWeight='700'; val.style.fontSize='13px'; val.textContent = r[1];
      row.appendChild(label); row.appendChild(val); body.appendChild(row);
    });

    card.appendChild(body);
    return card;
  }

  function renderCards(items, type){
    grid.innerHTML = '';
    if(type === 'ibm'){
      items.forEach(it=>{
        const satuan = it['Satuan Kapasitas'] || '-';
        grid.appendChild(buildCard(it['Program'], it, satuan));
      });
      return;
    }

    // aggregate per sector
    const order = ['Air Minum','Air Limbah','Persampahan','PKS','BPB'];
    const map = {};
    items.forEach(row=>{
      const key = (row.Sektor||'').trim() || 'Unknown';
      if(!map[key]) map[key] = { Sektor:key, 'Jumlah Unit':0, 'Nilai Investasi (Miliar)':0, 'Berfungsi':0, 'Tidak Berfungsi':0, 'Kapasitas Terpasang':0, 'Kapasitas Terpakai':0, 'Idle Capacity':0, 'Luas Penanganan':'-', 'Luas Kawasan':'-', 'Satuan Kapasitas': (row['Satuan Kapasitas']||'-') };
      map[key]['Jumlah Unit'] += Number(row['Jumlah Unit']||0);
      map[key]['Nilai Investasi (Miliar)'] += Number(row['Nilai Investasi (Miliar)']||0);
      map[key]['Berfungsi'] += Number(row['Berfungsi']||0);
      map[key]['Tidak Berfungsi'] += Number(row['Tidak Berfungsi']||0);

      const parseNum = v => {
        if(!v) return 0;
        if(typeof v === 'number') return v;
        const m = String(v).match(/[-+]?[0-9]*[.,]?[0-9]+/);
        return m ? Number(m[0].replace(',','.')) : 0;
      };
      map[key]['Kapasitas Terpasang'] += parseNum(row['Kapasitas Terpasang']);
      map[key]['Kapasitas Terpakai'] += parseNum(row['Kapasitas Terpakai']);
      map[key]['Idle Capacity'] += parseNum(row['Idle Capacity']);

      if(row['Luas Penanganan'] && row['Luas Penanganan'] !== '-') map[key]['Luas Penanganan'] = row['Luas Penanganan'];
      if(row['Luas Kawasan'] && row['Luas Kawasan'] !== '-') map[key]['Luas Kawasan'] = row['Luas Kawasan'];
      if(row['Satuan Kapasitas'] && row['Satuan Kapasitas'] !== '-') map[key]['Satuan Kapasitas'] = row['Satuan Kapasitas'];
    });

    order.forEach(k=>{
      const item = map[k] || { Sektor:k, 'Jumlah Unit':0, 'Nilai Investasi (Miliar)':0, 'Berfungsi':0, 'Tidak Berfungsi':0, 'Kapasitas Terpasang':0, 'Kapasitas Terpakai':0, 'Idle Capacity':0, 'Luas Penanganan':'-', 'Luas Kawasan':'-', 'Satuan Kapasitas':'-' };
      const satuan = item['Satuan Kapasitas'] || '-';
      const display = Object.assign({}, item);
      display['Kapasitas Terpasang'] = item['Kapasitas Terpasang'] ? Number(item['Kapasitas Terpasang']).toFixed(2) : '-';
      display['Kapasitas Terpakai'] = item['Kapasitas Terpakai'] ? Number(item['Kapasitas Terpakai']).toFixed(2) : '-';
      display['Idle Capacity'] = item['Idle Capacity'] ? Number(item['Idle Capacity']).toFixed(2) : '-';
      display['Nilai Investasi (Miliar)'] = item['Nilai Investasi (Miliar)'] ? Number(item['Nilai Investasi (Miliar)']).toFixed(2) : '-';
      grid.appendChild(buildCard(item.Sektor, display, satuan));
    });
  }

  // load JSON
  Promise.all([fetch(PATH_REG).then(r=>r.json()), fetch(PATH_IBM).then(r=>r.json())])
    .then(([reg, ibm])=>{
      dataReg = reg;
      dataIbm = ibm;
      setActive(tabs.all);
      renderCards(dataReg.concat(dataIbm), 'gabungan');
    })
    .catch(err=>{
      grid.innerHTML = '<div style="color:#ffb4b4">Gagal memuat data. Periksa path JSON di folder repo.</div>';
      console.error(err);
    });

  // tab events
  tabs.reg.addEventListener('click', ()=>{ setActive(tabs.reg); renderCards(dataReg, 'reguler'); });
  tabs.ibm.addEventListener('click', ()=>{ setActive(tabs.ibm); renderCards(dataIbm, 'ibm'); });
  tabs.all.addEventListener('click', ()=>{ setActive(tabs.all); renderCards(dataReg.concat(dataIbm), 'gabungan'); });

})();
</script>
<!-- END: Rekapitulasi -->
  
</body>
</html>
